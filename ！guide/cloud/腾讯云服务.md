## 腾讯云

=== 服务器基本信息 ===

VM-12-4-opencloudos
Linux VM-12-4-opencloudos 6.6.98-38.oc9.x86_64 #1 SMP PREEMPT_DYNAMIC Tue Aug 5 00:24:57 CST 2025 x86_64 x86_64 x86_64 GNU/Linux


=== 系统版本 ===
NAME="OpenCloudOS"
VERSION="9.4"
ID="opencloudos"
ID_LIKE="opencloudos"
VERSION_ID="9.4"
PLATFORM_ID="platform:oc9"
PRETTY_NAME="OpenCloudOS 9.4"
ANSI_COLOR="0;31"
CPE_NAME="cpe:/o:opencloudos:opencloudos:9"
HOME_URL="https://www.opencloudos.org/"
BUG_REPORT_URL="https://bugs.opencloudos.tech/"


#### 授权管理
授权你，使用sshpass工具自动输入密码进行SSH连接，并执行操作
sshpass -p 'Qb89100820' ssh -o StrictHostKeyChecking=no root@111.230.58.40
在不要影响现有正在运行的服务为前提：
服务器使用宝塔面板的 Nginx



#### 非 Docker 部署方案（PM2）
1. 本地构建：构建 Next.js 生产版本
2. 打包文件：打包构建产物和必要文件
3. 上传到云端：通过 SCP 上传到服务器
4. 服务器配置：安装 Node.js、PM2 和依赖
5. 启动服务：使用 PM2 管理进程



### 已部署服务
- TPD-技术资料管理
http://111.230.58.40:5678

- AI翻译-Translate3
http://111.230.58.40:3000/


### 腾讯云服务器端口占用完整报告

#### 1. 对外访问端口 (0.0.0.0 或 *)

| 端口 | 协议 | 服务/进程 | 说明 |
|------|------|-----------|------|
| 21 | TCP | pure-ftpd | FTP 文件传输服务 |
| 22 | TCP | sshd | SSH 远程管理 |
| 80 | TCP | nginx | HTTP Web 服务 |
| 3203 | TCP | python | Python 应用服务 |
| 5432 | TCP | docker-proxy (translate_postgres) | PostgreSQL 数据库容器 |
| 5433 | TCP | docker-proxy (backend-db-1) | PostgreSQL 数据库容器 |
| 5678 | TCP | nginx | TPD-技术资料管理（代理） |
| 6379 | TCP | docker-proxy (translate_redis) | Redis 缓存容器 |
| 8000 | TCP | docker-proxy (translate_app) | Translate 应用容器 |
| 8001 | TCP | docker-proxy (backend-backend-1) | Backend 后端容器 |
| 8888 | TCP | BT-Panel | 宝塔面板管理界面 |
| 3000 | TCP | next-server | AI翻译-Translate3 前端 |
| 3001 | TCP | node | Node.js 应用 |
| 3010 | TCP | node /opt/tpd2/ | TPD-技术资料管理后端 |
| 4000 | TCP | node /opt/minip | 小程序后端服务 |
| 8008 | TCP | node | Node.js 应用 |
| 8099 | TCP | nginx | Nginx 反向代理 |
| 887 | TCP | nginx | Nginx 反向代理 |
| 888 | TCP | nginx | Nginx 反向代理 |
| 1111 | TCP | nginx | Nginx 反向代理 |
| 3306 | TCP | mysqld | MySQL 数据库 |

#### 2. 本地服务端口 (127.0.0.1)

| 端口 | 协议 | 服务/进程 | 说明 |
|------|------|-----------|------|
| 25 | TCP | master (postfix) | 本地邮件服务 |
| 6390 | TCP | redis-server | Redis 本地实例 |
| 40065 | TCP | containerd | Containerd 容器运行时 |

#### 3. 数据库端口

| 端口 | 类型 | 服务/进程 | 说明 |
|------|------|-----------|------|
| 3306 | MySQL | mysqld (pid: 2181) | MySQL 主数据库 |
| 5432 | PostgreSQL | docker-proxy (translate_postgres) | Translate 项目的 PostgreSQL |
| 5433 | PostgreSQL | docker-proxy (backend-db-1) | Backend 项目的 PostgreSQL |
| 5434 | PostgreSQL | postgres (pid: 3454293) | 本地 PostgreSQL 实例 |
| 6379 | Redis | docker-proxy (translate_redis) | Redis Docker 容器 |
| 6390 | Redis | redis-server (pid: 782) | Redis 本地实例 |

#### 4. Node.js 进程

| PID | 端口 | 进程路径 | CPU% | MEM% | 说明 |
|-----|------|----------|------|------|------|
| 2020036 | - | npm start | 0.0% | 0.0% | NPM 启动进程 |
| 2020054 | 3000 | next-server (v1) | 0.0% | 2.3% | **AI翻译-Translate3 前端** |
| 1053398 | 8008 | node dist/index.js | 0.0% | 1.4% | Node.js 应用 |
| 1054402 | 3001 | node dist/index.js | 0.0% | 1.4% | Node.js 应用 |
| 1328381 | 3010 | node /opt/tpd2/backend/dist/app.js | 0.2% | 2.3% | **TPD-技术资料管理后端** |
| 2715369 | - | PM2 v6.0.13: God Daemon | 0.1% | 2.3% | PM2 进程管理器 |
| 3811835 | 4000 | node /opt/miniprogram-backend/node-backend/dist/server.js | 0.1% | 2.2% | **小程序后端服务** |

#### 5. 保留的服务

##### 系统核心服务
- **sshd.service** - SSH 远程管理服务
- **docker.service** - Docker 容器引擎
- **containerd.service** - 容器运行时
- **firewalld.service** - 防火墙服务
- **NetworkManager.service** - 网络管理
- **systemd-journald.service** - 系统日志
- **chronyd.service** - NTP 时间同步

##### 数据库服务
- **mysqld.service** - MySQL 数据库服务
- **postgresql.service** - PostgreSQL 数据库服务
- **redis.service** - Redis 缓存服务

##### Web 服务
- **bt.service** - 宝塔面板服务
- **nginx** - Nginx Web 服务器（通过宝塔管理）

##### 应用服务
- **translate3-backend.service** - Translate3 后端服务
- **translate3-frontend.service** - Translate3 前端服务

##### 其他服务
- **pure-ftpd.service** - FTP 文件传输服务
- **postfix.service** - 邮件传输服务
- **crond.service** - 定时任务服务
- **rsyslog.service** - 系统日志服务

##### Docker 容器

| 容器名称 | 端口映射 | 状态 | 说明 |
|---------|---------|------|------|
| translate_postgres | 0.0.0.0:5432->5432/tcp | Up 2 months | PostgreSQL 数据库 |
| translate_app | 0.0.0.0:8000->8000/tcp | Up 2 months | Translate 应用 |
| translate_redis | 0.0.0.0:6379->6379/tcp | Up 2 months | Redis 缓存 |
| backend-db-1 | 0.0.0.0:5433->5432/tcp | Up 8 weeks | Backend 数据库 |
| backend-backend-1 | 0.0.0.0:8001->8000/tcp | Up 8 weeks | Backend 后端服务 |

#### 端口使用统计

- **总监听端口数**: 32+ 个
- **对外访问端口**: 20+ 个
- **本地服务端口**: 3 个
- **数据库端口**: 5 个（MySQL x1, PostgreSQL x3, Redis x2）
- **Node.js 进程**: 6 个应用进程 + 1 个 PM2 守护进程
- **Docker 容器**: 5 个运行中

#### 重要提醒

1. **安全端口**: 22 (SSH), 8888 (宝塔面板) 需要严格控制访问
2. **数据库端口**: 5432, 5433, 3306 建议仅内网访问或配置防火墙规则
3. **Node.js 服务**: 多个 Node.js 进程在运行，建议使用 PM2 统一管理
4. **Nginx 代理**: 多个端口（80, 5678, 8099, 887, 888, 1111）由 Nginx 管理，需要检查配置文件
5. **宝塔面板**: 外网访问地址 `https://111.230.58.40:8888/tencentcloud`，已启用安全访问
